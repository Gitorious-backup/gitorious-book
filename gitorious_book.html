<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>The Gitorious Book</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="The Gitorious Book"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-10-17 22:12:58 CEST"/>
<meta name="author" content="Thomas Kjeldahl Nilsson"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">The Gitorious Book</h1>


<p><strong>This is the new, official Gitorious
 documentation and is a work in progress.</strong> New content will
 arrive here gradually. In the meantime, please seek out the <a
 href="http://gitorious.org/gitorious/pages/Home">project wiki</a> or
 the Gitorious <a
 href="http://groups.google.com/group/gitorious?hl=en">Google
 group</a> for documentation and troubleshooting.</p>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Introduction</a>
<ul>
<li><a href="#sec-1-1">History</a></li>
<li><a href="#sec-1-2">Features &amp; benefits</a></li>
<li><a href="#sec-1-3">FOSS licensing</a></li>
<li><a href="#sec-1-4">Current maintainers</a></li>
<li><a href="#sec-1-5">Funding</a></li>
</ul>
</li>
<li><a href="#sec-2">How Gitorious works</a>
<ul>
<li><a href="#sec-2-1">Overview: services, processes, packages</a></li>
<li><a href="#sec-2-2">How the web frontend works</a></li>
<li><a href="#sec-2-3">How the git backend works</a></li>
</ul>
</li>
<li><a href="#sec-3">Installation</a>
<ul>
<li><a href="#sec-3-1">Automated installation</a></li>
<li><a href="#sec-3-2">Manual installation</a>
<ul>
<li><a href="#sec-3-2-1">Overview - common steps</a></li>
<li><a href="#sec-3-2-2">CentOS / RHEL</a></li>
<li><a href="#sec-3-2-3">Debian / Ubuntu</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-4">Using the web frontend</a>
<ul>
<li><a href="#sec-4-1">Registering your user</a></li>
<li><a href="#sec-4-2">Adding your ssh key</a></li>
<li><a href="#sec-4-3">Creating your first project and repo</a></li>
<li><a href="#sec-4-4">Using Gitorious as a git remote</a></li>
<li><a href="#sec-4-5">Collaborating with others: merge requests</a></li>
</ul>
</li>
<li><a href="#sec-5">Upgrades</a>
<ul>
<li><a href="#sec-5-1">Versioning</a>
<ul>
<li><a href="#sec-5-1-1">Risks of upgrading</a></li>
<li><a href="#sec-5-1-2">Patch versions</a></li>
<li><a href="#sec-5-1-3">Minor versions</a></li>
<li><a href="#sec-5-1-4">Major versions</a></li>
<li><a href="#sec-5-1-5">How often/when will Gitorious update its version?</a></li>
</ul>
</li>
<li><a href="#sec-5-2">Approach 1: Manual upgrade</a></li>
<li><a href="#sec-5-3">Approach 2: Snapshot old instance, restore state in a newly installed instance</a></li>
</ul>
</li>
<li><a href="#sec-6">Authentication &amp; authorization</a>
<ul>
<li><a href="#sec-6-1">LDAP integration</a></li>
<li><a href="#sec-6-2">Private projects/repositories</a></li>
</ul>
</li>
<li><a href="#sec-7">Keeping it running</a>
<ul>
<li><a href="#sec-7-1">Monit</a></li>
<li><a href="#sec-7-2">Diagnostic checks</a></li>
</ul>
</li>
<li><a href="#sec-8">Backup, recovery, migration, cloning</a>
<ul>
<li><a href="#sec-8-1">Using the snapshot/restore commands</a></li>
<li><a href="#sec-8-2">How to perform snapshots in older Gitorious versions</a></li>
<li><a href="#sec-8-3">Assumptions and caveats</a></li>
<li><a href="#sec-8-4">Scenarios</a>
<ul>
<li><a href="#sec-8-4-1">Backup and disaster recovery</a></li>
<li><a href="#sec-8-4-2">Migrations and clones</a></li>
<li><a href="#sec-8-4-3">Upgrading</a></li>
<li><a href="#sec-8-4-4">Snapshots and rollbacks for development and testing</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-9">Scaling</a>
<ul>
<li><a href="#sec-9-1">Caching with Vagrant</a></li>
<li><a href="#sec-9-2">Horizontal scaling</a></li>
<li><a href="#sec-9-3">Vertical scaling</a></li>
<li><a href="#sec-9-4">Repository hashing/sharding</a></li>
</ul>
</li>
<li><a href="#sec-10">Troubleshooting</a>
<ul>
<li><a href="#sec-10-1">Diagnostics CLI tool</a></li>
<li><a href="#sec-10-2">Diagnostics dashboard url</a></li>
<li><a href="#sec-10-3">Check the FAQ</a></li>
<li><a href="#sec-10-4">Ask the community</a></li>
</ul>
</li>
<li><a href="#sec-11">Frequently Asked Questions</a></li>
<li><a href="#sec-12">Contributing to Gitorious</a>
<ul>
<li><a href="#sec-12-1">Bug reports</a></li>
<li><a href="#sec-12-2">Hacking on Gitorious</a>
<ul>
<li><a href="#sec-12-2-1">Setting up your development environment</a></li>
<li><a href="#sec-12-2-2">Deploying and testing your code in a "cleanroom" VM</a></li>
<li><a href="#sec-12-2-3">Coding styleguide</a></li>
<li><a href="#sec-12-2-4">Branching model</a></li>
</ul>
</li>
<li><a href="#sec-12-3">Don't have time yourself? Fund new features!</a></li>
</ul>
</li>
<li><a href="#sec-13">Need more help?</a>
<ul>
<li><a href="#sec-13-1">Google Group</a></li>
<li><a href="#sec-13-2">#gitorious on IRC</a></li>
<li><a href="#sec-13-3">Gitorious AS services &amp; products</a></li>
</ul>
</li>
<li><a href="#sec-14">Feedback</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="todo TODO">TODO</span> Introduction</h2>
<div class="outline-text-2" id="text-1">


</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">History</h3>
<div class="outline-text-3" id="text-1-1">

</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2">Features &amp; benefits</h3>
<div class="outline-text-3" id="text-1-2">

</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3">FOSS licensing</h3>
<div class="outline-text-3" id="text-1-3">

</div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4">Current maintainers</h3>
<div class="outline-text-3" id="text-1-4">

</div>

</div>

<div id="outline-container-1-5" class="outline-3">
<h3 id="sec-1-5">Funding</h3>
<div class="outline-text-3" id="text-1-5">

</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="todo TODO">TODO</span> How Gitorious works</h2>
<div class="outline-text-2" id="text-2">


</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1">Overview: services, processes, packages</h3>
<div class="outline-text-3" id="text-2-1">

</div>

</div>

<div id="outline-container-2-2" class="outline-3">
<h3 id="sec-2-2">How the web frontend works</h3>
<div class="outline-text-3" id="text-2-2">

<p>   Briefly describe Rails/web architecture
</p></div>

</div>

<div id="outline-container-2-3" class="outline-3">
<h3 id="sec-2-3">How the git backend works</h3>
<div class="outline-text-3" id="text-2-3">

<p>File structure, how we handle incoming ssh/git operations, the gitorious script
</p></div>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="todo TODO">TODO</span> Installation</h2>
<div class="outline-text-2" id="text-3">


</div>

<div id="outline-container-3-1" class="outline-3">
<h3 id="sec-3-1">Automated installation</h3>
<div class="outline-text-3" id="text-3-1">

</div>

</div>

<div id="outline-container-3-2" class="outline-3">
<h3 id="sec-3-2">Manual installation</h3>
<div class="outline-text-3" id="text-3-2">


</div>

<div id="outline-container-3-2-1" class="outline-4">
<h4 id="sec-3-2-1">Overview - common steps</h4>
<div class="outline-text-4" id="text-3-2-1">


</div>

</div>

<div id="outline-container-3-2-2" class="outline-4">
<h4 id="sec-3-2-2">CentOS / RHEL</h4>
<div class="outline-text-4" id="text-3-2-2">

</div>

</div>

<div id="outline-container-3-2-3" class="outline-4">
<h4 id="sec-3-2-3">Debian / Ubuntu</h4>
<div class="outline-text-4" id="text-3-2-3">

</div>
</div>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="todo TODO">TODO</span> Using the web frontend</h2>
<div class="outline-text-2" id="text-4">


</div>

<div id="outline-container-4-1" class="outline-3">
<h3 id="sec-4-1">Registering your user</h3>
<div class="outline-text-3" id="text-4-1">

</div>

</div>

<div id="outline-container-4-2" class="outline-3">
<h3 id="sec-4-2">Adding your ssh key</h3>
<div class="outline-text-3" id="text-4-2">

</div>

</div>

<div id="outline-container-4-3" class="outline-3">
<h3 id="sec-4-3">Creating your first project and repo</h3>
<div class="outline-text-3" id="text-4-3">

</div>

</div>

<div id="outline-container-4-4" class="outline-3">
<h3 id="sec-4-4">Using Gitorious as a git remote</h3>
<div class="outline-text-3" id="text-4-4">

</div>

</div>

<div id="outline-container-4-5" class="outline-3">
<h3 id="sec-4-5">Collaborating with others: merge requests</h3>
<div class="outline-text-3" id="text-4-5">

</div>
</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5">Upgrades</h2>
<div class="outline-text-2" id="text-5">


</div>

<div id="outline-container-5-1" class="outline-3">
<h3 id="sec-5-1">Versioning</h3>
<div class="outline-text-3" id="text-5-1">


<p>
As of July 7th 2011, Gitorious adopted a standard versioning scheme,
and the initial version was 2.0.0. This version was chosen
arbitrarily, but we chose 2 over 1 to reflect the fact that Gitorious
has been through a few major changes since its inception, and we've
had been around for almost 4 years at that point.
</p>
<p>
Below you can read about the types of changes and what they demand
from someone upgrading Gitorious. The changes are listed in order of
most to least frequent. Releases are available as tags of the form
“vx.y.z” in the Gitorious mainline repository.
</p>

</div>

<div id="outline-container-5-1-1" class="outline-4">
<h4 id="sec-5-1-1">Risks of upgrading</h4>
<div class="outline-text-4" id="text-5-1-1">


<p>
We will do our best to keep releases stable. Every release will be run
in production on gitorious.org prior to being tagged.
</p>
</div>

</div>

<div id="outline-container-5-1-2" class="outline-4">
<h4 id="sec-5-1-2">Patch versions</h4>
<div class="outline-text-4" id="text-5-1-2">


<p>
Patch versions indicate changes with minor impact for installs. In
general, the rules for patch versions are:
</p>
<ul>
<li>Should not require database migrations
</li>
<li>Should not require configuration changes or additions
</li>
<li>Should not require changes in CSS (e.g. by changing existing markup)
</li>
</ul>


<p>
In general: If you have a local install, you should be able to safely
upgrade patch releases without changing anything, even if you have
local CSS adjustments.
</p>
<p>
Because of these restrictions, patch upgrades should be considered
fairly trivial and of minimal risk. Refer to Upgrading for information
on checking your current version and upgrading.
</p>
</div>

</div>

<div id="outline-container-5-1-3" class="outline-4">
<h4 id="sec-5-1-3">Minor versions</h4>
<div class="outline-text-4" id="text-5-1-3">


<p>
Minor versions are bigger changes or changes that require action on
your part other than simply pulling from Git and restarting your
app. These changes may include:
</p>
<ul>
<li>Database migrations
</li>
<li>Required configuration changes and/or additions
</li>
<li>Substantial changes/additions to the view
</li>
<li>API changes in models and key lib classes
</li>
</ul>


<p>
Each minor version will receive its own entry in the documentation
chapter you're currently reading.
</p>
</div>

</div>

<div id="outline-container-5-1-4" class="outline-4">
<h4 id="sec-5-1-4">Major versions</h4>
<div class="outline-text-4" id="text-5-1-4">


<p>
Major versions will presumably occur infrequently, and there is no
specific rules to trigger an upgrade. Our rule of thumb right now is
that if a new version of Gitorious requires an entirely new
installation guide of its own, it’s probably a major release. However,
we may also up the major version number due to the addition of
substantial new features, redesigns and whatnot.
</p>
</div>

</div>

<div id="outline-container-5-1-5" class="outline-4">
<h4 id="sec-5-1-5">How often/when will Gitorious update its version?</h4>
<div class="outline-text-4" id="text-5-1-5">


<p>
Releases will be made on an irregular schedule, and will coincide with
gitorious.org deployments, but not in a 1:1 ratio. Occasionally we
deploy Gitorious a number of times throughout a single week, but do
not expect more than one version per week. Follow this page, or better
– the mailing list for updates.
</p>
</div>
</div>

</div>

<div id="outline-container-5-2" class="outline-3">
<h3 id="sec-5-2">Approach 1: Manual upgrade</h3>
<div class="outline-text-3" id="text-5-2">


<p>
If your version of Gitorious is really old, please start with this
guide: <a href="https://gitorious.org/gitorious/pages/LegacyUpgrade">LegacyUpgrade</a> ("really old" = older than February 3rd
2009/92bb70a1).
</p>
<p>
If your version Gitorious is only a little old, refer to <a href="https://gitorious.org/gitorious/pages/BundlerSetup">BundlerSetup</a>
("a little old" = older than January 24th 2011/c44237f).
</p>
<ul>
<li id="sec-5-2-1">The changelog tool<br/>

<p>
As of Gitorious 2.0.0, Gitorious ships with a simple changelog
tool. The tool consists of a single rake task that can tell you what
version you are currently on and what versions are available to
you. To use it, invoke the following command from the root of your
installation:
</p>
<p>
<code>bundle exec rake changelog</code>
</p>
<p>
The tool will give you a list of available version along with an arrow
indicating your current version. If the arrow points to a green
number, you're on top of things. If it points to a red number, it
means that upgrades are available, and you are encouraged to stay up
to date.
</p>
<p>
To display a changelog for changes between your current version and
another version, run the tool with the `VERSION` environment variable
set:
</p>
<p>
<code>bundle exec rake changelog VERSION=2.0.1</code>
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-2">Before upgrading<br/>

<p>
No matter how simple an upgrade may look, we strongly encourage you to
always back up your database and repository data prior to upgrades. If
nothing else, an upgrade is a good time to get some snapshots if you
don't already have scheduled backups of your system. It's also a good
idea to keep a copy of Gitorious configuration files outside the
actual install.
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-3">Upgrading patch versions<br/>

<p>
Patch upgrades should be trivial in nature. The steps are simple:
</p>
<p>
    <code>cd /path/to/gitorious</code>
    <code>git fetch git://gitorious.org/gitorious/mainline.git</code>
    <code>git merge v2.x.y</code>
    <code>rake assets:clear</code>
</p>
<p>
Note that `rake assets:clear` was not available prior to 2.1.0. 2.0.x
can be directly upgraded to 2.1.0, see below.
</p>
<p>
As of 2.1.0 you also need these steps for any upgrade:
</p>
<p>
    <code>git submodule init</code>
    <code>git submodule update</code>
    <code>rake db:migrate</code>
</p>
<p>
Finally, restart all services. This includes the webserver, the poller
and the git daemon. x/y depends on the actual version.
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-4">Upgrading customized installs<br/>

<p>
If your Gitorious setup has changes, you may experience conflicts when
pulling in changes. It is recommended to push your patched version of
Gitorious somewhere, for example to itself, so you can easily clone
Gitorious to a local machine, or somewhere else on the server to make
sure that the patch will apply cleanly before attempting the upgrade.
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-5">Sample upgrade<br/>

<p>
Assuming you are on v2.0.0 or newer:
</p>



<pre class="src src-shell">bundle exec rake changelog
Available versions
v2.0.1              Next increment
-&gt; v2.0.0           First versioned version of Gitorious
</pre>


<p>
Obviously, there's a new version in town, so let's see what it offers:
</p>



<pre class="src src-shell">bundle exec rake changelog VERSION=2.0.1
Changes between v2.0.0 and v2.0.1:
A longer description appears here
</pre>


<p>
This looks good, so let's upgrade:
</p>
<p>
<code>git fetch git://gitorious.org/gitorious/mainline.git</code>
</p>
<p>
<code>git merge v2.0.0</code>
</p>
<p>
<code>rm public/stylesheets/all.css public/javascripts/all.js public/javascripts/capillary.js public/**/*/gts-*.*</code>
</p>
<p>
<code>touch tmp/restart.txt</code>
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-6">Upgrading from 2.0.x to 2.1<br/>

<p>
You can upgrade directly from any 2.0.x version directly to 2.1.0. Start by reviewing changes:
</p>
<p>
    <code>bundle exec rake changelog VERSION=2.1.0</code>
</p>
<p>
If this looks good, back up everything (see above), and get started:
</p>
<p>
    <code>git fetch git://gitorious.org/gitorious/mainline.git</code>
</p>
<p>
    <code>git merge v2.1.0</code>
</p>
<p>
    <code>rake assets:clear</code>
</p>
<p>
Gitorious now has submodules. Initialize and pull them:
</p>
<p>
    <code>git submodule init</code>
</p>
<p>
    <code>git submodule update</code>
</p>
<p>
Upgrade the database:
</p>
<p>
    <code>rake db:migrate</code>
</p>
<p>
Then restart your server (assuming you're using Passenger):
</p>
<p>
    <code>touch tmp/restart.txt</code>
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-7">Upgrading from 2.1.x to 2.2<br/>

<p>
You can upgrade directly from any 2.1.x version directly to 2.2.0. Start by reviewing changes:
</p>
<p>
    <code>bundle exec rake changelog VERSION=2.2.0</code>
</p>
<p>
If this looks good, back up everything (see above), and get started:
</p>
<p>
    <code>git fetch git://gitorious.org/gitorious/mainline.git</code>
</p>
<p>
    <code>git merge v2.2.0</code>
</p>
<p>
    <code>rake assets:clear</code>
</p>
<p>
    <code>git submodule --init update</code>
</p>
<p>
Upgrade the database:
</p>
<p>
    <code>rake db:migrate</code>
</p>
<p>
Then restart your server (assuming you're using Passenger):
</p>
<p>
    <code>touch tmp/restart.txt</code>
</p>
<p>
If you want to use the new <a href="#private-repositories-feature">https://gitorious.org/gitorious/pages/PrivateRepositories</a>, set the
<code>enable_private_repositories</code> setting to `true` in
config/gitorious.yml. See the sample configuration in
config/gitorious.sample.yml for more information.
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-8">Upgrading from 2.2.x to 2.3<br/>

<p>
You can upgrade directly from any 2.2.x version directly to 2.3.0. Start by reviewing changes:
</p>
<p>
    <code>bundle exec rake changelog VERSION=2.3.0</code>
</p>
<p>
If this looks good, back up everything (see above), and get started:
</p>
<p>
    <code>git fetch git://gitorious.org/gitorious/mainline.git</code>
</p>
<p>
    <code>git merge v2.3.0</code>
</p>
<p>
    <code>rake assets:clear</code>
</p>
<p>
Gitorious now has submodules. Initialize and pull them:
</p>
<p>
    <code>git submodule init</code>
</p>
<p>
    <code>git submodule update</code>
</p>
<p>
Upgrade the database:
</p>
<p>
    <code>rake db:migrate</code>
</p>
<p>
Then restart your server (assuming you're using Passenger):
</p>
<p>
    <code>touch tmp/restart.txt</code>
</p>
</li>
</ul>
<ul>
<li id="sec-5-2-9">Upgrading from 2.3.0 to 2.3.1<br/>

<p>
To upgrade from version 2.3.0 to 2.3.1, follow these steps:
</p>
<p>
    <code>git fetch git://gitorious.org/gitorious/mainline.git</code>
</p>
<p>
    <code>git merge v2.3.1</code>
</p>
<p>
    <code>bundle install</code>
</p>
<p>
    <code>rake assets:clear</code>
</p>
<p>
    <code>touch tmp/restart.txt</code>
</p>
</li>
</ul>
</div>

</div>

<div id="outline-container-5-3" class="outline-3">
<h3 id="sec-5-3">Approach 2: Snapshot old instance, restore state in a newly installed instance</h3>
<div class="outline-text-3" id="text-5-3">


<p>
The nuclear option, and the simplest way to go in some cases. If you
need to make a major version leap (aka. migrating an ancient Gitorious
installation) you might want to consider simply snapshotting the old
one and recovering in a freshly installed new one. This also has the
benefit of not screwing up your older, working installation if
something goes wrong.
</p>
<p>
(See the backup/recovery chapter below)
</p>
</div>
</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6"><span class="todo TODO">TODO</span> Authentication &amp; authorization</h2>
<div class="outline-text-2" id="text-6">


</div>

<div id="outline-container-6-1" class="outline-3">
<h3 id="sec-6-1">LDAP integration</h3>
<div class="outline-text-3" id="text-6-1">

</div>

</div>

<div id="outline-container-6-2" class="outline-3">
<h3 id="sec-6-2">Private projects/repositories</h3>
<div class="outline-text-3" id="text-6-2">

</div>
</div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7"><span class="todo TODO">TODO</span> Keeping it running</h2>
<div class="outline-text-2" id="text-7">


</div>

<div id="outline-container-7-1" class="outline-3">
<h3 id="sec-7-1">Monit</h3>
<div class="outline-text-3" id="text-7-1">

</div>

</div>

<div id="outline-container-7-2" class="outline-3">
<h3 id="sec-7-2">Diagnostic checks</h3>
<div class="outline-text-3" id="text-7-2">

</div>
</div>

</div>

<div id="outline-container-8" class="outline-2">
<h2 id="sec-8">Backup, recovery, migration, cloning</h2>
<div class="outline-text-2" id="text-8">


<p>
Gitorious has support for snapshotting and restoring its state, which
makes it possible to easily perform backups, disaster recovery,
cloning and migration of Gitorious sites.
</p>

</div>

<div id="outline-container-8-1" class="outline-3">
<h3 id="sec-8-1">Using the snapshot/restore commands</h3>
<div class="outline-text-3" id="text-8-1">


<p>
If you're on a recent version of Gitorious (&gt;v2.3.0) you'll find two
commands under the scripts directory: scripts/snapshot and
scripts/restore. Each of them takes a single parameter: the path of
the tar file you want your Gitorious installation backed up to, or
restored from. Note that you'll need to launch the commands from the
root directory of your Gitorious install (the directory where you find
your Rakefile, Gemfile, config directory etc).
</p>
</div>

</div>

<div id="outline-container-8-2" class="outline-3">
<h3 id="sec-8-2">How to perform snapshots in older Gitorious versions</h3>
<div class="outline-text-3" id="text-8-2">


<p>
It's fairly straightforward to add these new snapshot|restore commands
to an older Gitorious instance a well: you only need to clone the
latest version of the Gitorious code, and copy the following files to
the same locations in your current, older installation:
</p>
<p>
<code>script/restore</code>
<code>script/snapshot</code>
<code>lib/tasks/backup.rake</code>
</p>
</div>

</div>

<div id="outline-container-8-3" class="outline-3">
<h3 id="sec-8-3">Assumptions and caveats</h3>
<div class="outline-text-3" id="text-8-3">


<ul>
<li>For disaster recovery, you'll first need to get a functional
  installation of Gitorious up and running, after which you can run
  the restore command to bring in your data again. Note that the
  snapshot tarball also includes the configuration files from your old
  Gitorious installation. They are not automatically copied into your
  new installation, but can be used to recreate your old config in
  your new Gitorious installation (useful if your previous Gitorious
  installation had custom LDAP integration, custom hooks etc).

</li>
<li>Snapshots will not preserve any custom code or theming you may have
  added to your Gitorious installation: any such local modifications
  will need to be backed up and restored separately

</li>
<li>Some operations in Gitorious are asynchronous, meaning they are
  performed by publishing/consuming messages on a queue. The
  snapshot/restore commands don't currently capture or restore the
  state of the queue, so any current work on the queue will be lost.

</li>
<li>The snapshot/recovery commands assume that you have the time and
  disk-space to slurp down all your hosted repos into a local
  tarball. Sites with huge amounts of git repository data may
  therefore need more custom backup schemes.

</li>
<li>The restore command assumes that no breaking changes have happened
  between the version you snapshot from, and the version you restore
  your data into. In the future, major Gitorious version jumps may
  necessitate a more manual restore procedure due to changes in
  configurations, db schema, folder structure etc.
</li>
</ul>


</div>

</div>

<div id="outline-container-8-4" class="outline-3">
<h3 id="sec-8-4">Scenarios</h3>
<div class="outline-text-3" id="text-8-4">


<p>
The snapshot|restore commands are useful for multiple tasks beyond
just standard backups.
</p>

</div>

<div id="outline-container-8-4-1" class="outline-4">
<h4 id="sec-8-4-1">Backup and disaster recovery</h4>
<div class="outline-text-4" id="text-8-4-1">


<p>
Run periodic backups, for instance via cron. Execute the snapshot
command, for example like this script/snapshot
/tmp/todays-snapshot.tar. Transfer the newly created tarball to
another server, offsite location or something like Amazon S3.
</p>
<p>
If disaster strikes on your Gitorious installation, install a new
instance of Gitorious, then run script/restore todays-snapshot.tar to
restore your old state in the new installation.
</p>
</div>

</div>

<div id="outline-container-8-4-2" class="outline-4">
<h4 id="sec-8-4-2">Migrations and clones</h4>
<div class="outline-text-4" id="text-8-4-2">


<p>
The same procedure is useful if you just need to move or clone your
Gitorious state from one server to another. Snapshot the old one, copy
the tarball file over to the other installation and restore
there. Simple.
</p>
</div>

</div>

<div id="outline-container-8-4-3" class="outline-4">
<h4 id="sec-8-4-3">Upgrading</h4>
<div class="outline-text-4" id="text-8-4-3">


<p>
Different scenario, same procedure: if you need to upgrade from an
older version of Gitorious and don't want to bother with carefully
upgrading your Gitorious instance across multiple versions, you can
simply snapshot the state of your old Gitorious site, install a fresh
new Gitorious instance and just restore your state there.
</p>
</div>

</div>

<div id="outline-container-8-4-4" class="outline-4">
<h4 id="sec-8-4-4">Snapshots and rollbacks for development and testing</h4>
<div class="outline-text-4" id="text-8-4-4">


<p>
If you're a developer extending, customizing or developing new
features for Gitorious, you can use the snapshot|restore commands to
simply setting up and restoring multiple standard database/repository
states in order to simplify testing.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-9" class="outline-2">
<h2 id="sec-9"><span class="todo TODO">TODO</span> Scaling</h2>
<div class="outline-text-2" id="text-9">


</div>

<div id="outline-container-9-1" class="outline-3">
<h3 id="sec-9-1">Caching with Vagrant</h3>
<div class="outline-text-3" id="text-9-1">

</div>

</div>

<div id="outline-container-9-2" class="outline-3">
<h3 id="sec-9-2">Horizontal scaling</h3>
<div class="outline-text-3" id="text-9-2">

<p>   what sort of hardware will you need to keep a single server running
   under misc typical usage scenarios?
</p></div>

</div>

<div id="outline-container-9-3" class="outline-3">
<h3 id="sec-9-3">Vertical scaling</h3>
<div class="outline-text-3" id="text-9-3">

<p>   distributing the load over multiple serves
</p></div>

</div>

<div id="outline-container-9-4" class="outline-3">
<h3 id="sec-9-4">Repository hashing/sharding</h3>
<div class="outline-text-3" id="text-9-4">


</div>
</div>

</div>

<div id="outline-container-10" class="outline-2">
<h2 id="sec-10">Troubleshooting</h2>
<div class="outline-text-2" id="text-10">


<p>
You're running your own Gitorious site. Now something seems to be
broken. Where do you start?
</p>

</div>

<div id="outline-container-10-1" class="outline-3">
<h3 id="sec-10-1">Diagnostics CLI tool</h3>
<div class="outline-text-3" id="text-10-1">


<p>
Gitorious includes a self-diagnostic tool (available in v2.3.0 and
onwards).
</p>
<p>
Execute scripts/diagnose (as superuser/root), and Gitorious will print
out a summary of its internals. Obvious problems in your setup will
show up here, which should give you a clue as to what could be amiss
in your installation.
</p>
</div>

</div>

<div id="outline-container-10-2" class="outline-3">
<h3 id="sec-10-2">Diagnostics dashboard url</h3>
<div class="outline-text-3" id="text-10-2">


<p>
You can also check the health of the site via the web frontend. If you
are a site admin, browse to /admin/diagnostics at your Gitorious
site. You'll be greeted with a diagnostics summary very similar to the
script/diagnose command.
</p>
</div>

</div>

<div id="outline-container-10-3" class="outline-3">
<h3 id="sec-10-3">Check the FAQ</h3>
<div class="outline-text-3" id="text-10-3">


<p>
(See FAQ chapter below)
</p>
</div>

</div>

<div id="outline-container-10-4" class="outline-3">
<h3 id="sec-10-4">Ask the community</h3>
<div class="outline-text-3" id="text-10-4">


<p>
If you're still stuck, consider asking the Gitorious community for
suggestions.
</p>
<p>
The core contributors and quite a few community members subscribe to
the <a href="http://groups.google.com/group/gitorious?hl=en">Gitorious Google Group</a>. There's also an IRC channel
available: #gitorious at freenode.net
</p>
<p>
Finally, if you are considering paid support/help, note that <a href="http://gitorious.com">Gitorious AS</a> offers commercial support.
</p>
</div>
</div>

</div>

<div id="outline-container-11" class="outline-2">
<h2 id="sec-11"><span class="todo TODO">TODO</span> Frequently Asked Questions</h2>
<div class="outline-text-2" id="text-11">

</div>

</div>

<div id="outline-container-12" class="outline-2">
<h2 id="sec-12">Contributing to Gitorious</h2>
<div class="outline-text-2" id="text-12">


</div>

<div id="outline-container-12-1" class="outline-3">
<h3 id="sec-12-1">Bug reports</h3>
<div class="outline-text-3" id="text-12-1">


<p>
Found a bug or annoyance? Please let the maintainers know via the official
issuetracker at <a href="https://issues.gitorious.org/">https://issues.gitorious.org/</a>.
</p>
</div>

</div>

<div id="outline-container-12-2" class="outline-3">
<h3 id="sec-12-2">Hacking on Gitorious</h3>
<div class="outline-text-3" id="text-12-2">


</div>

<div id="outline-container-12-2-1" class="outline-4">
<h4 id="sec-12-2-1"><span class="todo TODO">TODO</span> Setting up your development environment</h4>
<div class="outline-text-4" id="text-12-2-1">


<p>
Howto: Set up enough dependencies and code locally to run the Gitorious test suite.
</p>
</div>

</div>

<div id="outline-container-12-2-2" class="outline-4">
<h4 id="sec-12-2-2"><span class="todo TODO">TODO</span> Deploying and testing your code in a "cleanroom" VM</h4>
<div class="outline-text-4" id="text-12-2-2">


<p>
Howto: Deploy and test your code in a basic gitorious community edition VM
</p>
</div>

</div>

<div id="outline-container-12-2-3" class="outline-4">
<h4 id="sec-12-2-3">Coding styleguide</h4>
<div class="outline-text-4" id="text-12-2-3">


<p>
As Gitorious is a codebase of decent size (by Ruby standards at
least), we try to adhere to a few guidelines to keep the codebase
clean.
</p>
<p>
The number one takeaway is that there's some level of flexibility in
the "rules" outlined below, but the most important thing is that your
code <span style="text-decoration:underline;">should look good</span> and be easily <span style="text-decoration:underline;">readable</span> and <span style="text-decoration:underline;">understandable</span>
for everyone else. The Gitorious codebase has its dark corners,
possibly filled with dragons, but we try to improve things as we see
them. "Leave the source in a better state than you found it" is solid
advice.
</p>
<p>
Pay attention to what you commit; always review pending changes with
`git diff &ndash;staged` and look for things that violates the outlines
below (git is being helpful and highlights some things, such as
trailing whitespace).
</p>
<p>
In general, try to follow the style of the existing code, and pay
attention to how the code you're writing <span style="text-decoration:underline;">actually looks</span>, not just
how it works.
</p>
<ul>
<li id="sec-12-2-3-1">General Guidelines<br/>

<ul>
<li>Lines should stay below 80 chars or so.
</li>
<li>No tabs.
</li>
<li>Don't get too clever.
</li>
<li>No trailing whitespace
</li>
</ul>


</li>
</ul>
<ul>
<li id="sec-12-2-3-2">Ruby<br/>

<p>
Generally the points in Christian Neukirchens
<a href="#RUBY-STYLE">http://github.com/chneukirchen/styleguide/raw/master/RUBY-STYLE</a> apply.
</p>
</li>
</ul>
<ul>
<li id="sec-12-2-3-3">Javascript<br/>

<ul>
<li>4 spaces, no tabs
</li>
<li>80 chars or less line length
</li>
<li>Local variables must use the `var` keyword
</li>
<li>Use (one) blank line to group statements together where suited
</li>
<li>Always use a single space after a keyword, and before a curly brace.
</li>
<li>Curly braces goes on the same line
</li>
</ul>





<pre class="src src-javascript"><span style="color: #586e75;">// </span><span style="color: #586e75;">Wrong</span>
<span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">foo</span> (<span style="color: #268bd2;">arg</span>){
<span style="color: #586e75;">// </span><span style="color: #586e75;">Wrong</span>
<span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">foo</span>(<span style="color: #268bd2;">arg</span>)
{
<span style="color: #586e75;">// </span><span style="color: #586e75;">Correct</span>
<span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">foo</span>(<span style="color: #268bd2;">arg</span>) {
</pre>



<p>
The same applies for conditionals:
</p>



<pre class="src src-javascript"><span style="color: #586e75;">// </span><span style="color: #586e75;">Wrong</span>
<span style="color: #859900; font-weight: bold;">if</span> (arg){
<span style="color: #586e75;">// </span><span style="color: #586e75;">Wrong</span>
<span style="color: #859900; font-weight: bold;">if</span>(arg)
{
<span style="color: #586e75;">// </span><span style="color: #586e75;">Correct</span>
<span style="color: #859900; font-weight: bold;">if</span> foo(arg) {
    ...
} <span style="color: #859900; font-weight: bold;">else</span> {
    ...
}
</pre>


<p>
One possible exception to the above is if the conditionals argument is
wrapped on multiple lines, the brace can be placed on a new line to
ease readability of the conditional body:
</p>



<pre class="src src-javascript"><span style="color: #859900; font-weight: bold;">if</span> ((foo &amp;&amp; barIsJustAWordUsedforDemonstrations) ||
    kittensAreFluffy &amp;&amp; doesNotSayWoof)
{
    ...
}
</pre>


<p>
However, long boolean expressions should be avoided in the first place.
</p>
</li>
</ul>
<ul>
<li id="sec-12-2-3-4">CSS<br/>

<ul>
<li>four space indent
</li>
<li>no tabs
</li>
<li>multiple selectors on seperate lines, unless singleworded
</li>
</ul>





<pre class="src src-css"><span style="color: #268bd2;"> </span><span style="color: #586e75;">/* </span><span style="color: #586e75;">wrong </span><span style="color: #586e75;">*/</span>
<span style="color: #268bd2;">\#foo #bar div.foo, #baz p#quux span.foo </span>{
    ...
}
<span style="color: #586e75;">/* </span><span style="color: #586e75;">Correct </span><span style="color: #586e75;">*/</span>
<span style="color: #268bd2;">\#foo #bar div.foo,</span>
<span style="color: #268bd2;">\#baz p#quux span.foo </span>{
    ...
}
</pre>



<ul>
<li>Opening brace on the same line as the selector
</li>
</ul>


</li>
</ul>
<ul>
<li id="sec-12-2-3-5">HTML<br/>

<ul>
<li>2 spaces indendation
</li>
<li>No tabs
</li>
<li>Prefer to indent deep nesting on a newline+indent, so the structure is easier to follow
</li>
</ul>


</li>
</ul>
</div>

</div>

<div id="outline-container-12-2-4" class="outline-4">
<h4 id="sec-12-2-4">Branching model</h4>
<div class="outline-text-4" id="text-12-2-4">


<p>
Gitorious uses
[the git-flow branching model](<a href="http://nvie.com/posts/a-successful-git-branching-model/">http://nvie.com/posts/a-successful-git-branching-model/</a>)
for branching. This means that the master branch is stable, and is
only merged to once a feature has been completed.
</p>
<p>
New features are created in feature branches (named `feature/$name`)
and then merged into the `next` branch once finished. Such features
arrive in `master` as new releases.
</p>
<p>
When contributing new features into Gitorious as merge requests, these
should be started the `next` branch, and marked as such when proposed.
</p>
<p>
The exception to this is hotfixes, which may be started from and
proposed merged into `master`. Please note that hotfixes should not
implement new functionality.
</p>
</div>
</div>

</div>

<div id="outline-container-12-3" class="outline-3">
<h3 id="sec-12-3">Don't have time yourself? Fund new features!</h3>
<div class="outline-text-3" id="text-12-3">


<p>
If your company has urgent need of new features/modifications in
Gitorious, please get in touch with the core contributors via
team@gitorious.org for funding development of your proposed features.
</p>
</div>
</div>

</div>

<div id="outline-container-13" class="outline-2">
<h2 id="sec-13"><span class="todo TODO">TODO</span> Need more help?</h2>
<div class="outline-text-2" id="text-13">


</div>

<div id="outline-container-13-1" class="outline-3">
<h3 id="sec-13-1">Google Group</h3>
<div class="outline-text-3" id="text-13-1">

</div>

</div>

<div id="outline-container-13-2" class="outline-3">
<h3 id="sec-13-2">#gitorious on IRC</h3>
<div class="outline-text-3" id="text-13-2">

</div>

</div>

<div id="outline-container-13-3" class="outline-3">
<h3 id="sec-13-3">Gitorious AS services &amp; products</h3>
<div class="outline-text-3" id="text-13-3">


</div>
</div>

</div>

<div id="outline-container-14" class="outline-2">
<h2 id="sec-14"><span class="todo TODO">TODO</span> Feedback</h2>
<div class="outline-text-2" id="text-14">

</div>
</div>
</div>

</body>
</html>
